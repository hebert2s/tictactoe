<!DOCTYPE html>
<html>
<head>
	<title>TicTacToe</title>
</head>
<body>
<b>TicTacToe<BR>Author: hebert2@gmail.com</b>
<BR>Click in a box/Pos/button to play
<BR>X = you 
<BR>0 = computer move
<BR>
<br>
<div id='divtela'></div>
<BR>
<div id='divresultOfGame'></div>
<script type="text/javascript">
let vt = [0,0,0,0,0,0,0,0,0];
let CO='O';
let US='X';
let endGame=false;
showGrid();

function cpuPlay() {
	canPlay=true;
	qtde=0;
	vt.forEach(function (value, i, array) {
		if (value) qtde++;
	});
	if (qtde==1 && (!vt[4]) ) {
		vt[4]=CO;
		canPlay=false;
	}
	// first Computer atack 
	//horizont
	if (vt[0]==CO && vt[1]==CO && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }
	if (vt[0]==CO && vt[2]==CO && canPlay && !vt[1]) {vt[1]=CO; canPlay=false; }
	if (vt[1]==CO && vt[2]==CO && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[3]==CO && vt[4]==CO && canPlay && !vt[5]) {vt[5]=CO; canPlay=false; }
	if (vt[3]==CO && vt[5]==CO && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==CO && vt[5]==CO && canPlay && !vt[3]) {vt[3]=CO; canPlay=false; }

	if (vt[6]==CO && vt[7]==CO && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[6]==CO && vt[8]==CO && canPlay && !vt[7]) {vt[7]=CO; canPlay=false; }
	if (vt[7]==CO && vt[8]==CO && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }

	//  vertical
	if (vt[0]==CO && vt[3]==CO && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }
	if (vt[0]==CO && vt[6]==CO && canPlay && !vt[3]) {vt[3]=CO; canPlay=false; }
	if (vt[3]==CO && vt[6]==CO && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[1]==CO && vt[4]==CO && canPlay && !vt[7]) {vt[7]=CO; canPlay=false; }
	if (vt[1]==CO && vt[7]==CO && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==CO && vt[7]==CO && canPlay && !vt[1]) {vt[1]=CO; canPlay=false; }

	if (vt[2]==CO && vt[5]==CO && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[2]==CO && vt[8]==CO && canPlay && !vt[5]) {vt[5]=CO; canPlay=false; }
	if (vt[5]==CO && vt[8]==CO && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }


	// atack cross
	if (vt[0]==CO && vt[4]==CO && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[0]==CO && vt[8]==CO && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==CO && vt[8]==CO && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[2]==CO && vt[4]==CO && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }
	if (vt[2]==CO && vt[6]==CO && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==CO && vt[6]==CO && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }


	// computer in defense
	//horizont
	if (vt[0]==US && vt[1]==US && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }
	if (vt[0]==US && vt[2]==US && canPlay && !vt[1]) {vt[1]=CO; canPlay=false; }
	if (vt[1]==US && vt[2]==US && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[3]==US && vt[4]==US && canPlay && !vt[5]) {vt[5]=CO; canPlay=false; }
	if (vt[3]==US && vt[5]==US && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==US && vt[5]==US && canPlay && !vt[3]) {vt[3]=CO; canPlay=false; }

	if (vt[6]==US && vt[7]==US && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[6]==US && vt[8]==US && canPlay && !vt[7]) {vt[7]=CO; canPlay=false; }
	if (vt[7]==US && vt[8]==US && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }

	//  vertical
	if (vt[0]==US && vt[3]==US && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }
	if (vt[0]==US && vt[6]==US && canPlay && !vt[3]) {vt[3]=CO; canPlay=false; }
	if (vt[3]==US && vt[6]==US && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[1]==US && vt[4]==US && canPlay && !vt[7]) {vt[7]=CO; canPlay=false; }
	if (vt[1]==US && vt[7]==US && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==US && vt[7]==US && canPlay && !vt[1]) {vt[1]=CO; canPlay=false; }

	if (vt[2]==US && vt[5]==US && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[2]==US && vt[8]==US && canPlay && !vt[5]) {vt[5]=CO; canPlay=false; }
	if (vt[5]==US && vt[8]==US && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }


	// atack cross
	if (vt[0]==US && vt[4]==US && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (vt[0]==US && vt[8]==US && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==US && vt[8]==US && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }

	if (vt[2]==US && vt[4]==US && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }
	if (vt[2]==US && vt[6]==US && canPlay && !vt[4]) {vt[4]=CO; canPlay=false; }
	if (vt[4]==US && vt[6]==US && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }

	randomNumber=(Math.floor(Math.random() * 100));
	if (randomNumber<26 && canPlay && !vt[0]) {vt[0]=CO; canPlay=false; }
	if (randomNumber>74 && canPlay && !vt[8]) {vt[8]=CO; canPlay=false; }
	if (randomNumber>25 && randomNumber<51 && canPlay && !vt[2]) {vt[2]=CO; canPlay=false; }
	if (randomNumber>50 && randomNumber<75 && canPlay && !vt[6]) {vt[6]=CO; canPlay=false; }

	vt.forEach(function (value, i, array) {
		if (value==0 && canPlay) {
			vt[i]=CO;
			canPlay=false;
		}
	});
}


function checkEndGame(WH) {
	if (vt[0]==WH && vt[1]==WH && vt[2]==WH && !endGame) haveWinner(WH);
	if (vt[3]==WH && vt[4]==WH && vt[5]==WH && !endGame) haveWinner(WH);
	if (vt[6]==WH && vt[7]==WH && vt[8]==WH && !endGame) haveWinner(WH);

	if (vt[0]==WH && vt[3]==WH && vt[6]==WH && !endGame) haveWinner(WH);
	if (vt[1]==WH && vt[4]==WH && vt[7]==WH && !endGame) haveWinner(WH);
	if (vt[2]==WH && vt[5]==WH && vt[8]==WH && !endGame) haveWinner(WH);

	if (vt[0]==WH && vt[4]==WH && vt[8]==WH && !endGame) haveWinner(WH);
	if (vt[2]==WH && vt[4]==WH && vt[6]==WH && !endGame) haveWinner(WH);

	qtde=0;
	vt.forEach(function (value, i, array) {
		if (value) qtde++;
	});
	if (qtde==9 && !endGame) {
		document.getElementById("divresultOfGame").innerHTML = '<h1>DRAW GAME</h1>';	
		endGame=true;
	}
}


function haveWinner(WH) {	
	if (WH==CO) WH='Computer';
	if (WH==US) WH='YOU';
	document.getElementById("divresultOfGame").innerHTML ='<h1>' +WH+' win </h1>';	
	endGame=true;
}

function fnClicou(i) {
	if (!endGame) {
		vt[i]=US;
		showGrid();
		cpuPlay();
		showGrid();
	}
}

function showGrid() {	
	if (!endGame) {
		let h='<table border="1"><tr>';
		vez=0;
		vt.forEach(function (value, i, array) {
			vez++;
			if (value==0) {
				x='<CENTER><button onclick="fnClicou('+i+')"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </button></CENTER>';
			} else {
				x='<CENTER>&nbsp;&nbsp;&nbsp;&nbsp;'+vt[i]+'&nbsp;&nbsp;&nbsp;&nbsp;</CENTER>';
			}
			h+='<td>'+x+'</td>';
			if (vez==3 || vez==6) {
				h+='</tr><tr>';
			}
			//console.log(value, i);
		});
		h+='</tr>';
		h+='</table>';
		document.getElementById("divtela").innerHTML = h;	
	}
	if (!endGame) {
		checkEndGame(CO);
	}
	if (!endGame) {
		checkEndGame(US);
	}
}

</script>
</body>
</html>